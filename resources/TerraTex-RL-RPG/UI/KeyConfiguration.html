<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8"/>
    <title>Registration</title>
    <script src="general/Scripts/jquery-3.1.1.min.js"></script>
    <script src="general/Scripts/bootstrap.min.js"></script>
    <link rel="stylesheet" href="general/Styles/bootstrap/bootstrap.css"/>
    <link rel="stylesheet" href="custom/styles.css"/>
</head>
<body>
<div class="container-fluid">
    <div class="card">
        <div class="card-header font-weight-bold">
            TerraTex - Bindings
        </div>
        <table class="table table-hover">
            <tr>
                <th class="w-25">
                    Taste/n
                </th>
                <th class="w-50">
                    Funktion
                </th>
                <th class="w-25">
                    Bearbeitung
                </th>
            </tr>
            <tr>
                <td data-key-value="none" data-key-modifier="0">
                    ~no~Key~defined~
                </td>
                <td data-function-name="ShowCursor">
                    Zeige Cursor
                </td>
                <td>
                    <div class="btn-group btn-group-sm">
                        <button class="btn btn-primary">Taste/n Ändern</button>
                        <button class="btn btn-danger">Zurücksetzen</button>
                    </div>
                </td>
            </tr>
            <tr>
                <td data-key-value="none" data-key-modifier="0">
                    ~no~Key~defined~
                </td>
                <td data-function-name="ToggleEngine">
                    Motor An/Aus
                </td>
                <td>
                    <div class="btn-group btn-group-sm">
                        <button class="btn btn-primary">Taste/n Ändern</button>
                        <button class="btn btn-danger">Zurücksetzen</button>
                    </div>
                </td>
            </tr>
            <tr>
                <td data-key-value="none" data-key-modifier="0">
                    ~no~Key~defined~
                </td>
                <td data-function-name="ToggleLight">
                    Licht An/Aus
                </td>
                <td>
                    <div class="btn-group btn-group-sm">
                        <button class="btn btn-primary">Taste/n Ändern</button>
                        <button class="btn btn-danger">Zurücksetzen</button>
                    </div>
                </td>
            </tr>
        </table>
    </div>
    <div class="card">
        <div class="card-header font-weight-bold">
            Eigene Binds
        </div>
        <table class="table table-hover">
            <tr>
                <th class="w-25">
                    Taste/n
                </th>
                <th class="w-50">
                    Chateingabe
                </th>
                <th class="w-25">
                    Bearbeitung
                </th>
            </tr>

            <tr>
                <td data-key-value="none" data-key-modifier="0">
                    ~no~Key~defined~
                </td>
                <td>
                    ~no~Text~defined~
                </td>
                <td>
                    <div class="btn-group btn-group-sm">
                        <button class="btn btn-primary">Taste Ändern</button>
                        <button class="btn btn-info">Text Ändern</button>
                        <button class="btn btn-danger">Löschen</button>
                    </div>
                </td>
            </tr>
        </table>
    </div>
    <div class="btn-group pftr">
        <div class="btn btn-danger btn-border-white" id="close"> Beenden / Abbrechen </div>
        <div class="btn btn-success btn-border-white" id="save"> Speichern </div>
    </div>

    <script>
        $(document).ready(function() {
            $("#close").click(function() {
                resourceCall("closeWindow");
            });

            $("#save").click(function() {
                //@todo: read keys + modifier
                const showCursor = $("[data-function-name=ShowCursor]").parent().find("td:first-child");
                const toggleEngine = $("[data-function-name=ToggleEngine]").parent().find("td:first-child");
                const toggleLight = $("[data-function-name=ToggleLight]").parent().find("td:first-child");

                let keyDefinition = {
                    functionKeys: {
                        ShowCursor: {
                            key: showCursor.text(),
                            keyValue: showCursor.attr("data-key-value"),
                            keyModifier: showCursor.attr("data-key-modifier")
                        },
                        ToggleEngine: {
                            key: toggleEngine.text(),
                            keyValue: toggleEngine.attr("data-key-value"),
                            keyModifier: toggleEngine.attr("data-key-modifier")
                        },
                        ToggleLight: {
                            key: toggleLight.text(),
                            keyValue: toggleLight.attr("data-key-value"),
                            keyModifier: toggleLight.attr("data-key-modifier")
                        }
                    },
                    customBindings: [
                        // {Key: , keyValue: , keyModifier: , content: }
                    ],
                };

                let jsondata = JSON.stringify(keyDefinition);
                resourceCall("save", jsondata);
            });

            resourceCall("loadComplete");
        });
    </script>
</div>
</body>
</html>